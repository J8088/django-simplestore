{% extends "base.html" %}
{% load thumbnail %}
{% load crispy_forms_tags %}

{% block content %}
    <div class="container">

        <div class="row">
            <div class="col-sm-12 col-md-4">
                <h3>Checkout</h3>
            </div>
        </div>

        <div class="row">
            <form action="{{ request.path }}" method="post">
                {% csrf_token %}
                <div class="col-sm-12 col-md-6">
                    <h4>Personal Details</h4>
                    {{ order_form|crispy }}
                </div>

                <div class="col-sm-12 col-md-6">
                    <h4>Delivery Details</h4>
                    {{ address_form|crispy }}
                </div>
                <button type="submit" class="btn btn-primary">Submit</button>
            </form>
        </div>

        <div class="row">
            <div class="col-sm-12 col-md-12 pull-left">
                <h4>Order Review</h4>
                {% for cart_item in cart.cartitem_set.all %}
                    <div class="media">
                        <div class="media-left">
                            <a href="{% url "products:detail" cart_item.product.slug %}">
                                <img src="{% thumbnail cart_item.product.image 80x80 crop %}">
                            </a>
                        </div>
                        <div class="media-body text-right">
                            <h5 class="media-heading">{{ cart_item.product.name }}</h5>
                            <strong>Quantity:</strong> {{ cart_item.quantity }} <br/>
                            <strong>Total Price:</strong> {{ cart_item.total_price|floatformat }}
                        </div>
                    </div>
                {% endfor %}
                <br />
                <p class="text-right"><strong>Subtotal</strong> {{ cart.price_subtotal|floatformat }}</p>
            </div>
        </div>

    </div>
{% endblock %}